/*
 \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
 \ Empresa.: Denny Paulista Azevedo Filho
 \ Programa: HOT12.PRG
 \ Modulo..: SubMenu de Apartamentos
 \ VersÆo..: 1.1
 \ Data....: 07-09-94
 \ RevisÆo.: 01-02-95
 \ Sistema.: MILENIUM - Automa‡Æo Hoteleira
 \ Funcao..: SubMenu de Apartamentos e rotinas relacionadas
 \ Analista: Denny Paulista Azevedo Filho
 \ Criacao.: Gerado pelo analista
 \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
*/

#INCLUDE 'INKEY.CH'
#INCLUDE 'ACHOICE.CH'
#INCLUDE 'BOX.CH'
#INCLUDE 'SETCURS.CH'


JANELA(1,04,22,08,33)
SELE 02
DO WHILE .T.
   NIVEL=2
   SET CURSOR OFF
   SETCOLOR(CORMUNO)
   KEYBOARD "1"
   OPC2=ACHOICE(05,23,07,32,MG,MLG,'VERMENU',1)
   DO CASE
      CASE OPC2 = 0
         EXIT
      CASE OPC2 = 1        //CADASTRO
         DO HOT121
      CASE OPC2 = 2        //MANUTENCAO
         DO HOT122
      CASE OPC2 = 3        //CONSULTA
         DO HOT123
   ENDCASE
ENDDO
JANELA(2)
RETURN

// CADASTRO DE APARTAMENTOS

PROCEDURE HOT121
SELE 02
JANELA(1,10,10,14,71,"Cadastro de Apartamentos")
@ 12,10 SAY "Ã Apto Â Liberado Â Di ria ÄÄÄÄÄÄÂ Descri‡„o ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´"
@ 13,11 SAY "      ³          ³              ³"
@ 14,17 SAY "ÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁ"
DO WHILE .T.
   INIC_VAR()
   MLIBERADO='S'
   SET CURSOR ON
   @ 13,12 GET MAPTO      PICT "999" VALID VERAPTO(MAPTO,'I')
   @ 13,19 SAY MLIBERADO
   @ 13,30 GET MDIARIA    PICT "@E 9,999.99"  VALID (MDIARIA>0)
   @ 13,45 GET MDESCRICAO PICT "@!"
   READ
   SET CURSOR OFF
   IF LASTKEY()=K_ESC
      SELE 04
      SET RELATION TO
      SELE 02
      EXIT
   ENDIF
   IF TRAVAREG()
     REPL_VAR()
     UNLOCK
   ELSE
     MENS('Apartamento nao Cadastrado')
   ENDIF
ENDDO
JANELA(2)
DO BARSTA
RETURN

// MANUTENCAO DE APARTAMENTOS

PROCEDURE HOT122

SET KEY K_RIGHT TO PROXIMO // SETA DIREITA
SET KEY K_LEFT TO ANTERIOR // SETA ESQUERDA
SET KEY K_HOME TO COMECO // TECLA HOME
SET KEY K_END TO FINAL // TECLA END
SET KEY K_DEL TO VERAPAGA1 // TECLA DEL
SET KEY 65 TO ALTERA1 // TECLA A
SET KEY 80 TO PESQUISA1 // TECLA P

@ 24,00 SAY PADR("[] Prox  [] Ant  [HOME] Inicio  [END] Fim  [DEL] Apaga  [A] Alt  [P] Pesq",80)
JANELA(1,10,10,14,71,"Manutencao de Apartamentos")
@ 12,10 SAY "Ã Apto Â Liberado Â Di ria ÄÄÄÄÄÄÂ Descri‡„o ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´"
@ 13,11 SAY "      ³          ³              ³"
@ 14,17 SAY "ÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁ"
GO TOP
DO WHILE .T.
   IGUAL_VAR()
   @ 13,12 SAY MAPTO      PICT "999"
   @ 13,19 SAY MLIBERADO  PICT "@!"
   @ 13,30 SAY MDIARIA    PICT "@E 9,999.99"
   @ 13,45 SAY MDESCRICAO PICT "@!"
   SET CURSOR OFF
   OLDCOLOR=SETCOLOR("N/N")
   WAIT ""
   SETCOLOR(OLDCOLOR)
   IF LASTKEY()=K_ESC
      EXIT
   ENDIF
ENDDO
SET KEY K_RIGHT TO
SET KEY K_LEFT TO
SET KEY K_HOME TO
SET KEY K_END TO
SET KEY K_DEL TO
SET KEY 65 TO
SET KEY 80 TO
JANELA(2)
DO BARSTA
RETURN

// CONSULTA DE APARTAMENTOS
PROCEDURE HOT123
MDB1={"APTO","LIBERADO","DIARIA","DESCRICAO"}
MDB2={"999","@!","@E 9,999.99","@!"}
MDB3={"Apto","Lib.","Diaria","Descricao"}
@ 24,00 SAY PADR("[ENTER] Altera Campo  [DEL] Apaga [ESC] Sai",80)
GO TOP
JANELA(01,02,12,22,69,"Consulta de Apartamento")
SET CURSOR OFF
DBEDIT(04,13,21,68,MDB1,"VERDB",MDB2,MDB3,"Ä","³")
DO BARSTA
JANELA(2)
RETURN

// FUNCAO ALTERA REGISTRO - MANUTECAO

PROCEDURE ALTERA1
SET KEY K_RIGHT TO
SET KEY K_LEFT TO
SET KEY K_HOME TO
SET KEY K_END TO
SET KEY K_DEL TO
SET KEY 65 TO
SET KEY 80 TO
IF RLOCK()
  SET CURSOR ON
  @ 13,12 GET MAPTO PICT "999" VALID VERAPTO(MAPTO,'A')
  @ 13,19 GET MLIBERADO PICT "@!" VALID MLIBERADO$"sSnN"
  @ 13,30 GET MDIARIA PICT "@E 9,999.99"  VALID (MDIARIA>0)
  @ 13,45 GET MDESCRICAO PICT "@!"
  READ
  SET CURSOR OFF
  IF LASTKEY()!=K_ESC
     REPL_VAR()
     UNLOCK
  ENDIF
ELSE
  MENS('Arquivo sendo utilizado, Aguarde !!!')
ENDIF
KEYBOARD CHR(13)
SET KEY K_RIGHT TO PROXIMO // SETA DIREITA
SET KEY K_LEFT TO ANTERIOR // SETA ESQUERDA
SET KEY K_HOME TO COMECO // TECLA HOME
SET KEY K_END TO FINAL // TECLA END
SET KEY K_DEL TO VERAPAGA1 // TECLA DEL
SET KEY 65 TO ALTERA1 // TECLA A
SET KEY 80 TO PESQUISA1 // TECLA P
Set Cursor Off
RETURN

// FUNCAO PROCURA REGISTRO - MANUTENCAO

PROCEDURE PESQUISA1
SET KEY K_RIGHT TO
SET KEY K_LEFT TO
SET KEY K_HOME TO
SET KEY K_END TO
SET KEY K_DEL TO
SET KEY 65 TO
SET KEY 80 TO
TAPTO=0
JANELA(01,09,25,15,53)
@ 11,28 SAY "Qual o Apartamento ???"
SET CURSOR ON
@ 13,37 GET TAPTO PICT "999" VALID VERAPTO(@TAPTO,'C')
READ
SET CURSOR OFF
JANELA(2)
IF (LASTKEY()=K_ESC)
   RETURN
ENDIF
KEYBOARD CHR(13)
SET KEY K_RIGHT TO PROXIMO // SETA DIREITA
SET KEY K_LEFT TO ANTERIOR // SETA ESQUERDA
SET KEY K_HOME TO COMECO // TECLA HOME
SET KEY K_END TO FINAL // TECLA END
SET KEY K_DEL TO VERAPAGA1 // TECLA DEL
SET KEY 65 TO ALTERA1 // TECLA A
SET KEY 80 TO PESQUISA1 // TECLA P
RETURN

//FUNCAO VERIFICA SE POSSIVEL OU NAO DELETAR O REGISTRO

PROCEDURE VERAPAGA1
DO CASE
   CASE LIBERADO='S'
        DO APAGA
   CASE LIBERADO='N'
       MENS('Apartamento Ocupado !!!')
   CASE LIBERADO='R'
       MENS('Apartamento Reservado !!!')
ENDCASE
KEYBOARD CHR(13)
RETURN
